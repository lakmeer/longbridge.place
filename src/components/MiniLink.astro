---
import type { CollectionEntry } from 'astro:content'
import type { AnyContentKey } from '@/content/config.ts'

import WikiLink   from '@/lib/wikilink.ts'
import MapPin     from '@/icons/map-pin.astro'
import UserCircle from '@/icons/head.astro'
import BookOpen   from '@/icons/book.astro'

interface Props {
  ref: string | { collection: AnyContentKey, slug: string }
  class?: string
}

const { ref, class: cl } = Astro.props
const entry = await WikiLink.fromAstroRef(ref).resolve()
---
{ typeof entry === 'string' ? entry :
  <a href=`/${entry!.collection}/${entry!.slug}` class:list={[ cl, "inline-flex minilink gap-1 hover:underline font-bold" ]}>
    { entry!.collection === 'location' && <><MapPin     class="size-5 "/> { entry!.data.name }</> }
    { entry!.collection === 'person'   && <><UserCircle class="size-5 "/> { entry!.data.day_name }</> }
    { entry!.collection === 'lore'     && <><BookOpen   class="size-5 "/> { entry!.data.title }</> }
  </a>
}
