---
import ThreadPage  from './_thread.astro'
import ChapterPage from './_chapter.astro'

import { getEntry, getCollection } from 'astro:content'

// All entries
export async function getStaticPaths() {
  const threads  = await getCollection('thread')
  const chapters = await getCollection('chapter')

  return [
    ...threads.map((entry) => ({
      params: { slug: entry.id },
      props: { entry }
    })),
    ...chapters.map((entry) => ({
      params: { slug: entry.slug },
      props: { entry },
    }))
  ]
}

// This entry
const { entry } = Astro.props
---
{ entry.collection === 'chapter' ? <ChapterPage {entry} /> :
  entry.collection === 'thread'  ? <ThreadPage  {entry} /> :
  null
}
